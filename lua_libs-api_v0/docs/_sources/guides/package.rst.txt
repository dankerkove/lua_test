Package Guide
======================================

The SmartThings Edge Device Drivers consist of 4 main components:

-  A configuration file
-  Fingerprint (Optional)
-  The driver code itself
-  Device profiles for the supported devices

Structure
---------

.. code ::

    package
    ├── src
    │   ├── init.lua
    │   ├── file1.lua
    │   ├── file2.lua
    │   └── <folder>
    │       ├── init.lua
    │       └── file3.lua
    ├── profiles
    │       ├── { Profile Name }.yaml
    │       └── { Other Profile Name }.yaml
    ├── config.yaml
    └── fingerprints.yaml (optional)


**Note**: ``fingerprints.yaml`` should not be included in packages for Drivers that don’t define fingerprints (LAN). Fingerprints are currently needed for Zigbee and Z-Wave devices.

Configuration file
------------------

The configuration file is a manifest and metadata for the driver.

**Example**

.. code:: yaml

    # config.yaml
    name: 'Hello World'
    packageKey: 'helloworld.example'

| **name**: Name of driver
| **packageKey**: Unique identifier of the package
|

Fingerprints
------------

Some devices, usually mesh, are added to the SmartThings platform
through the use of a fingerprint. Upon a device being discovered by the
Hub, some properties of the device are read and a device fingerprint is
created. The fingerprint is then sent to the SmartThings Cloud to look for a matching fingerprint.
Upon a successful match, the Edge Driver associated with the fingerprint is then
installed to the Hub to enable device operation.

LAN devices are an exception to this process. See here {link to
lan discovery docs}.

**Example**

.. code:: yaml

    # fingerprints.yaml
    zigbeeManufacturer:
      - id: "SmartThings/motionv4"
        manufacturer: SmartThings
        model: motionv4
        deviceProfileName: { Profile Name }
        deviceLabel: { Device Label }

| **id**: Unique identifier for fingerprint, namespaced by the driver
| **manufacturer**: Reported manufacturer of a device's endpoint
| **model**: Reported model of a device's endpoint
| **deviceProfileName**: Name of device profile that device should use
| **deviceLabel**: Label to initialize device record with

Driver
------

The Driver is the Lua code itself. This code will run on the Hub and implement
code necessary for communications to and from the device.  See :ref:`Structure`

For code contents of a Driver, see :ref:`Writing your first Lua driver`

Profiles
--------

Device profiles describe the type of device and its capabilities to the
SmartThings platform

**In the example below, ``hello world`` will appear as a light switch to the
platform**

.. code:: yaml

    # hello-world-profile
    name: hello-world.v1
    components:
    - id: main
      capabilities:
      - id: switch
        version: 1
      categories:
      - name: Light
    metadata:
      vid: SmartThings-smartthings-c2c-switch #generic-switch
      mnmn: SmartThings
      ocfDeviceType: oic.d.switch

**Note**: Package updates that remove a profile name will be rejected. Devices 
already using the removed profile would not reflect newly created devices to clients. 